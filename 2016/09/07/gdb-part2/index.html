<!DOCTYPE html>





<html lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="Using GNU&apos;s GDB Debugger 1. Memory Layout And The Stack From: http://www.dirac.org/linux/gdb/02a-Memory_Layout_And_The_Stack.php? 2. Breakpoints And Watchpoints So far you know how to list source code">
<meta name="keywords" content="c,gdb">
<meta property="og:type" content="article">
<meta property="og:title" content="gdb part2">
<meta property="og:url" content="https://yanruibo.github.io/2016/09/07/gdb-part2/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="Using GNU&apos;s GDB Debugger 1. Memory Layout And The Stack From: http://www.dirac.org/linux/gdb/02a-Memory_Layout_And_The_Stack.php? 2. Breakpoints And Watchpoints So far you know how to list source code">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2016-09-17T08:01:16.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="gdb part2">
<meta name="twitter:description" content="Using GNU&apos;s GDB Debugger 1. Memory Layout And The Stack From: http://www.dirac.org/linux/gdb/02a-Memory_Layout_And_The_Stack.php? 2. Breakpoints And Watchpoints So far you know how to list source code">
  <link rel="canonical" href="https://yanruibo.github.io/2016/09/07/gdb-part2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>gdb part2 | Blog</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Summary for Comprehensive Learning</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
      </li>
    
  </ul>

    

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://yanruibo.github.io/2016/09/07/gdb-part2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yrb">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">gdb part2

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2016-09-07 12:16:35" itemprop="dateCreated datePublished" datetime="2016-09-07T12:16:35+08:00">2016-09-07</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2016-09-17 16:01:16" itemprop="dateModified" datetime="2016-09-17T16:01:16+08:00">2016-09-17</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/c/" itemprop="url" rel="index"><span itemprop="name">c</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="using-gnus-gdb-debugger">Using GNU's GDB Debugger</h1>
<h2 id="memory-layout-and-the-stack">1. Memory Layout And The Stack</h2>
<p>From: <a href="http://www.dirac.org/linux/gdb/02a-Memory_Layout_And_The_Stack.php?printable=yes" target="_blank" rel="noopener">http://www.dirac.org/linux/gdb/02a-Memory_Layout_And_The_Stack.php?</a></p>
<h2 id="breakpoints-and-watchpoints">2. Breakpoints And Watchpoints</h2>
<p>So far you know how to list source code and run a program from within gdb. But you already knew how to do that without gdb. What else does gdb give us? To do anything really useful with gdb, you need to set breakpoints which temporarily pause your program's execution so you can do useful debugging work like inspecting variables and watching the program's execution in an atomic line-by-line fashion. This right here is the magic of a symbolic debugger.<br>
<a id="more"></a> Breakpoints come in three flavors:</p>
<ol type="1">
<li>A breakpoint stops your program whenever a particular point in the program is reached. We will discuss breakpoints momentarily.</li>
<li>A watchpoint stops your program whenever the value of a variable or expression changes. We'll discuss watchpoints later on in this chapter.</li>
<li>A catchpoint stops your program whenever a particular event occurs. We won't discuss catchpoints until I get a chance to write about them.</li>
</ol>
<p>A breakpoint stops your program whenever a particular place in the program is reached. Here are some examples of what a breakpoint does:</p>
<p>Mr. Computer, won't you please stop when... - you reach line 420 of the current source code file? - you enter the function validateInput()? - you reach line 2718 of the file video.c?</p>
<p>All those requests have one thing in common: they ask gdb to stop based on reaching some location within the program. That's what a breakpoint does. There are two things I'd like to mention before we start:</p>
<p>1.What does "stopping at line 5" mean?<br>
When gdb stops at "line 5", this means that gdb is currently waiting "between" lines 4 and 5. Line 5 hasn't executed yet. Keep this in mind! You can execute line 5 with the next command, but line 5 has not happened yet.</p>
<p>2.Why did gdb stop here?<br>
Sometimes you may be surprised at where gdb stops. You may have specified a breakpoint at line 5 of the source code, but gdb could stop at line 7, for instance. This can happen for 2 reasons. First, if you compile a program with optimization set, some lines of source code may be optimized out of existence; they exist in your source code, but not in the executable. Secondly, not every line of source code gets compiled into machine code instruction. See the section on "until" (FIXME: when I write it). Consider the code below: <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>   <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="number">2</span>      </span><br><span class="line"><span class="number">3</span>   <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">( <span class="keyword">void</span> )</span></span></span><br><span class="line"><span class="function">4   </span>&#123;</span><br><span class="line"><span class="number">5</span>        <span class="keyword">int</span> i;</span><br><span class="line"><span class="number">6</span>        i = <span class="number">3</span>;</span><br><span class="line"><span class="number">7</span>   </span><br><span class="line"><span class="number">8</span>        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">9</span>   &#125;</span><br></pre></td></tr></table></figure></p>
<p>Inserting a breakpoint at line X makes your program pause at line Y...</p>
<table>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>unoptimized code</th>
<th>unoptimized code</th>
<th>optimized code</th>
<th>optimized code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Breakpoint at line</td>
<td>rogram pauses at line</td>
<td>reakpoint set at line</td>
<td>rogram pauses at line</td>
</tr>
<tr class="even">
<td>1--4, main()</td>
<td>4</td>
<td>1--4, main()</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5, 6</td>
<td>6</td>
<td>5--9</td>
<td>9</td>
</tr>
<tr class="even">
<td>7, 8</td>
<td>8</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>9</td>
<td>9</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Each breakpoint, watchpoint, and catchpoint you set is assigned a number starting with 1. You use this number to refer to that breakpoint. To see the list of all breakpoints and watchpoints you've set, type info breakpoints (which can be abbreviated by i b. I show a sample resulting output: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(gdb) info breakpoints </span><br><span class="line">Num Type           Disp Enb Address    What</span><br><span class="line">1   breakpoint     keep y   0x080483f6 in main at try5.c:4</span><br><span class="line">		  breakpoint already hit 1 time</span><br><span class="line">2   breakpoint     keep n   0x0804841a in display at try5.c:14</span><br><span class="line">		  breakpoint already hit 1 time</span><br><span class="line">3   hw watchpoint  keep y   i</span><br></pre></td></tr></table></figure></p>
<p>According to the output, there are two breakpoints, one at line 4 and the other at line 14 of the source code. They are assigned to numbers 1 and 2 respectively. There is also a watchpoint set: the program will halt whenever the variable i (local to display()) changes value.</p>
<p>In addition to being assigned a number, each breakpoint and watchpoint can be enabled or disabled. A program's execution won't stop at a disabled breakpoint or watchpoint. By default, when you create a new breakpoint or watchpoint, it's enabled. To disable the breakpoint or watchpoint assigned to number <code>n</code>, type: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">disable n</span><br></pre></td></tr></table></figure></p>
<p>To re-enable this breakpoint or watchpoint, type: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enable n</span><br></pre></td></tr></table></figure></p>
<p>If you look at the sample output of info breakpoints above, you'll see that breakpoint 2 has been disabled.</p>
<h3 id="breaking">2.1 Breaking</h3>
<p>Compile and run the fgets program, which is a multi-filed program (the files are fgets.c, fgets.h, and main.c: <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//fgets.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"fgets.h"</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">TakeGuess</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *word)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> buffer[<span class="number">255</span>];</span><br><span class="line"></span><br><span class="line">	fgets(buffer, <span class="number">255</span>, <span class="built_in">stdin</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">strcmp</span>(buffer, word))</span><br><span class="line">			<span class="keyword">return</span> TRUE;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//fgets.h</span><br><span class="line">#ifndef fGETS_H</span><br><span class="line">#define FGETS_H</span><br><span class="line"></span><br><span class="line">#define TRUE  1</span><br><span class="line">#define FALSE 0</span><br><span class="line"></span><br><span class="line">int TakeGuess(const char *word);</span><br><span class="line"></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">//main.c</span><br><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &quot;fgets.h&quot;</span><br><span class="line"></span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">	char *word = &quot;password&quot;;</span><br><span class="line">	int  KeepGoing;</span><br><span class="line">	</span><br><span class="line">	printf(&quot;I&apos;m thinking of a word.  Let&apos;s see if you can guess it.\n&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	while ( KeepGoing )</span><br><span class="line">	&#123;</span><br><span class="line">		KeepGoing = TakeGuess(word);</span><br><span class="line"></span><br><span class="line">		if (KeepGoing = TRUE)</span><br><span class="line">			printf(&quot;Nope.  That&apos;s not right.\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	printf(&quot;Yes, that was the word!\n&quot;);</span><br><span class="line"></span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -c -g -W -Wall fgets.c main.c</span><br><span class="line">$ gcc -o fgets fgets.o main.o</span><br></pre></td></tr></table></figure>
<p>Note that the compiler generated a warning. That's because we used '-W -Wall' which instructs gcc to tell us when it sees what it thinks might be a common programming error. The best way to debug your program is to not put the bugs in the program to begin with. You should always use these gcc bug finding options. Let me be blunt here, and I hope I don't offend anyone. It's stupid not to use <strong>-W -Wall</strong> when you compile code. Plain and simple. Stupid. With a capital S. Most people don't use them, even people who are clearly better programmers than me. That's because even smart people can do dumb things. Don't you be dumb. Always use <strong>-W -Wall</strong>.</p>
<p>The program is a password guessing program. Take a moment to look through the code to see how it works. The program is ultra-simple so we can focus on learning GDB rather than trying to figure out complicated code like linked lists and whatnot. You should be able to deduce how the program works (and what the password is) in under a few seconds. Now run the code and notice it simply doesn't work. We'll first concentrate on learning how to set breakpoints, and then we'll debug the program.</p>
<h3 id="setting-basic-breakpoints">2.2 Setting Basic Breakpoints</h3>
<p>There are four major ways to set a breakpoint, in roughly the order that I personally use them.:</p>
<ol type="1">
<li>By function name.</li>
<li>By line number.</li>
<li>By filename and line number.</li>
<li>By address.</li>
</ol>
<h4 id="by-function-name">2.2.1 By Function Name</h4>
<p>We've already seen the most common way of setting a brekpoint: with the function name. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gdb fgets</span><br><span class="line">Using host libthread_db library &quot;/lib/tls/libthread_db.so.1&quot;.</span><br><span class="line">(gdb) break main</span><br><span class="line">Breakpoint 1 at 0x8048464: file main.c, line 6.</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<p>The <strong>"break main"</strong> command sets a breakpoint at the top of <strong>main()</strong>, which happens to be line 6 of <strong>main.c</strong>. If we now run the program, the program will stop at line 6. Recall from the previous discussion that this means that GDB will be sitting between lines 5 and 6. Line 6 will not have executed until we issue the <strong>step</strong> command: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(gdb) run</span><br><span class="line">Starting program: code/fgets/fgets </span><br><span class="line"></span><br><span class="line">Breakpoint 1, main () at main.c:6</span><br><span class="line">6               char *word = &quot;password&quot;;</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<h4 id="by-line-number">2.2.2 By Line Number</h4>
<p>A second way of setting breakpoints is with a line number. The line number refers to the file GDB is currently in. Right now, we're in <strong>main.c</strong>, so line numbers are with respect to that file for now. Let's set a breakpoint at line 9, where the <strong>printf()</strong> statement is. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(gdb) break 9</span><br><span class="line">Breakpoint 2 at 0x804846b: file main.c, line 9.</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<p>GDB has a <strong>continue</strong> command which we haven't seen yet. Once GDB pauses due to a breakpoint, the <strong>continue</strong> command will resume execution. Use <strong>continue</strong> to make sure that GDB pauses at line 9: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(gdb) continue</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">Breakpoint 2, main () at main.c:9</span><br><span class="line">9               printf(&quot;I&apos;m thinking of a word.  Let&apos;s see if you can guess it.\n&quot;);</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<h4 id="by-filename-and-line-number">2.2.3 By Filename And Line Number</h4>
<p>A third way of setting breakpoints is with a filename and line number, separated with a colon. Let's set a breakpoint at line 10 of <strong>fgets.c</strong>: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(gdb) break fgets.c:10</span><br><span class="line">Breakpoint 3 at 0x80483fd: file fgets.c, line 10.</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<h4 id="by-address">2.2.4 By Address</h4>
<p>A fourth way of setting breakpoints is with a memory address within the process's VM space. I'll find the address of TakeGuess() and set a breakpoint at that address: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print TakeGuess </span><br><span class="line">$1 = &#123;int (const char *)&#125; 0x80483f4 &lt;TakeGuess&gt;</span><br><span class="line">(gdb) break *0x80483f4</span><br><span class="line">Breakpoint 4 at 0x80483f4: file fgets.c, line 7.</span><br></pre></td></tr></table></figure></p>
<h3 id="breakpoint-numbers">2.3 Breakpoint Numbers</h3>
<p>You might have noticed that each breakpoint is given an integer identifier. For example, we've set 4 breakpoints already, and the last one we set (by address) was assigned the number 4. If you haven't noticed this, go back and take a look. Various operations can be performed on a breakpoint, like removing them. You can perform an operation on a particular breakpoint by referring to its integer identifier.</p>
<h3 id="removing-breakpoints">2.4 Removing Breakpoints</h3>
<p>Just as you can set breakpoints, you can also remove them. There are numerous ways to remove a breakpoint:</p>
<ul>
<li>If you want to remove the breakpoint by its location, use clear.</li>
<li>If you want to remove the breakpoint by its identifier, use delete.</li>
</ul>
<p>So let's use clear to remove the four breakpoints the way we set them; kind of like "undoing" what we did: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(gdb) clear *0x80483f4</span><br><span class="line">Deleted breakpoint 4 </span><br><span class="line">(gdb) clear fgets.c:10</span><br><span class="line">Deleted breakpoint 3 </span><br><span class="line">(gdb) clear 9</span><br><span class="line">Deleted breakpoint 2 </span><br><span class="line">(gdb) clear main</span><br><span class="line">Deleted breakpoint 1 </span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<p>The <strong>delete</strong> command deletes breakpoints by identifier, as opposed to <strong>clear</strong> which removes breakpoints based on their location. In fact, <strong>delete n</strong> deletes the breakpoint with identifier <strong>n</strong>. We investigate this command more fully in the exercises.</p>
<h4 id="exercises">2.4.1 Exercises</h4>
<ol type="1">
<li>If you've been following along with the tutorial, you shouldn't have any breakpoints set since we deleted them all with clear. Set three breakpoints wherever you like by the methods of your choice. Before you do, guess what their identifiers will be.</li>
<li>Use delete, not clear, to remove only the last breakpoint you set. This will leave you with two remaining breakpoints.</li>
<li>You should have two breakpoints left. delete with no arguments removes all breakpoints. Try it out, then quit GDB.</li>
</ol>
<h3 id="enabling-disabling-and-ignoring">2.5 Enabling, Disabling, And Ignoring</h3>
<p>Once set, there are only two ways to get rid of a breakpoint: remove it or quit GDB. GDB will continually break at the breakpoint. However, you'll sometimes find it useful to temporarily disable a breakpoint, that is, you do not want GDB to break at the breakpoint, but you want to keep the breakpoint there in case you need to debug that section of code again.</p>
<p>Breakpoints can be enabled and disabled. Simply put, your program will pause at an enabled breakpoint, but it will not pause at a disabled breakpoint.</p>
<p>You can enable or disable breakpoints using the <strong>enable</strong> and <strong>disable</strong> commands which take an argument of the breakpoint identifier for the breakpoint you want to enable or disable. Let's take a look at this using the <strong>fgets</strong> program that we previously used. Start a debugging session of <strong>fgets</strong> and place two breakpoints at lines 6, 9, and 12 of <strong>main.c</strong>: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ gdb fgets</span><br><span class="line">(gdb) break 6</span><br><span class="line">Breakpoint 1 at 0x8048464: file main.c, line 6.</span><br><span class="line">(gdb) break 9</span><br><span class="line">Breakpoint 2 at 0x804846b: file main.c, line 9.</span><br><span class="line">(gdb) break 12</span><br><span class="line">Breakpoint 3 at 0x8048477: file main.c, line 12.</span><br></pre></td></tr></table></figure></p>
<p>Disable breakpoint 2, run the program, and use <strong>continue</strong> to verify that breakpoint 2 does not pause execution. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disable 2</span><br><span class="line">(gdb) run</span><br><span class="line">Starting program: code/fgets/fgets </span><br><span class="line"></span><br><span class="line">Breakpoint 1, main () at main.c:6</span><br><span class="line">6               char *word = &quot;password&quot;;</span><br><span class="line">(gdb) continue </span><br><span class="line">Continuing.</span><br><span class="line">I&apos;m thinking of a word.  Let&apos;s see if you can guess it.</span><br><span class="line"></span><br><span class="line">Breakpoint 3, main () at main.c:12</span><br><span class="line">12              while ( KeepGoing )</span><br></pre></td></tr></table></figure></p>
<p>Confirmed, breakpoint 2 is disabled. Finally, enable breakpoint 2 and rerun the program. Use <strong>continue</strong> to verify that breakpoint 2 now pauses execution: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(gdb) enable 2</span><br><span class="line">(gdb) run</span><br><span class="line">The program being debugged has been started already.</span><br><span class="line">Start it from the beginning? (y or n) y</span><br><span class="line"></span><br><span class="line">Starting program: /www/p/linux/gdb/code/fgets/fgets </span><br><span class="line"></span><br><span class="line">Breakpoint 1, main () at main.c:6</span><br><span class="line">6               char *word = &quot;password&quot;;</span><br><span class="line">(gdb) continue </span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">Breakpoint 2, main () at main.c:9</span><br><span class="line">9               printf(&quot;I&apos;m thinking of a word.  Let&apos;s see if you can guess it.\n&quot;);</span><br></pre></td></tr></table></figure></p>
<p>Confirmed, once enabled, breakpoint 2 again pauses execution.</p>
<h4 id="exercises-1">2.5.1 Exercises</h4>
<ol type="1">
<li>The disable command permanently disabled a breakpoint until you explicitly enable it with enable. However, it's possible to temporarily disable a breakpoint. Use GDB's help utility to read about the ignore command, which disables a breakpoint "for n crossings".</li>
<li>Personally, I don't use ignore a whole lot. It seems like conditional breaking makes ignore not very useful, but you should still know of its existence. Hopefully you have GDB still open. Use ignore to disable breakpoint 3 (the one at line 12) for 3 crossings. Verify that it works.</li>
</ol>
<h3 id="listing-breakpoints">2.6 Listing Breakpoints</h3>
<p>So far, we've seen three commands that take a breakpoint's identifier as an argument: <strong>delete</strong>, <strong>enable</strong>, and <strong>disable</strong>. There are many others, which we'll cover later. The point is, breakpoint identifiers are useful, and you'll find yourself using them quite a bit. But how do you remember the identifiers for your breakpoints, or even where your breakpoints were set to begin with? There's a command, <strong>info breakpoints</strong> which lists all your breakpoints, their identifiers, and lots more information. Hopefully, GDB is still open from the previous subsection, so check it out: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(gdb) info breakpoints </span><br><span class="line">Num Type           Disp Enb Address    What</span><br><span class="line">1   breakpoint     keep y   0x08048464 in main at main.c:6</span><br><span class="line">        breakpoint already hit 1 time</span><br><span class="line">2   breakpoint     keep y   0x0804846b in main at main.c:9</span><br><span class="line">        breakpoint already hit 1 time</span><br><span class="line">3   breakpoint     keep y   0x08048477 in main at main.c:12</span><br></pre></td></tr></table></figure></p>
<p>This is a very important command, and I find myself using it all the time. It should be completely self explanatory except for a couple of things:</p>
<ol type="1">
<li>The <strong>Num</strong> field gives the identifier.</li>
<li>The <strong>Type</strong> field gives the type of breakpoint. 3. There are different types of breakpoints, like hardware watchpoints, which we'll cover shortly.</li>
<li>The <strong>Disp</strong> field (short for disposition) describes what will happen to the breakpoint the next time it's activated (the next time it pauses execution). <strong>keep</strong> indicates nothing will happen to the breakpoint, however, it's possible to disable or even remove a breakpoint the next time it's reached. These situations are identified by the <strong>Disp</strong> field.</li>
</ol>
<h2 id="stepping-and-resuming">3. Stepping And Resuming</h2>
<h3 id="setting-breakpoints-in-single-file-programs">3.1 Setting Breakpoints In Single File Programs</h3>
<p>There are many ways to set breakpoints. We'll go over each in turn. If you feel up to it, download try5.c and follow my example. Otherwise, you can simply follow the text (I list try5.c in the previous section). It's better if you do this alongside the tutorial, but since I'm showing gdb's output, it's not necessary. First, compile try5.c for debugging. <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//try5.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">(<span class="keyword">int</span> y)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">	display(x);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> ( i=<span class="number">0</span>; i&lt;x; ++i ) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"i is %d.\n"</span>, i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -Wall -W -g -o try5 try5.c</span><br></pre></td></tr></table></figure>
<p>The first (and easiest) way you can set a breakpoint is by specifying a line number. To break at line 6, simply type <strong>break 6</strong>. From now on, I'm not going to show the copyright when you first run gdb. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ gdb try5</span><br><span class="line">(gdb) break 6</span><br><span class="line">Breakpoint 1 at 0x80483f6: file try5.c, line 6.</span><br></pre></td></tr></table></figure></p>
<p>Wasn't that easy? You can also set breakpoints with a function name: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) break display</span><br><span class="line">Breakpoint 2 at 0x804841a: file try5.c, line 15.</span><br></pre></td></tr></table></figure></p>
<p>Disable the 1st breakpoint, and then look at what you've done: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disable 1</span><br><span class="line">(gdb) info breakpoints </span><br><span class="line">Num Type           Disp Enb Address    What</span><br><span class="line">1   breakpoint     keep n   0x080483f6 in main at try5.c:6</span><br><span class="line">2   breakpoint     keep y   0x0804841a in display at try5.c:15</span><br></pre></td></tr></table></figure></p>
<p>Now run the program. Remember, breakpoint 1 is disabled, so it'll stop at line 15. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(gdb) run</span><br><span class="line">Starting program: /www/p/linux/gdb/try5 </span><br><span class="line"></span><br><span class="line">Breakpoint 2, display (x=3) at try5.c:15</span><br><span class="line">15              for (i=0; i&lt;x; ++i) &#123;</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<p>We've seen 2 ways to set a breakpoint. Now here's a third. To set a breakpoint 2 lines down from the current line, use <strong>break +2</strong>. Similarly, you can set a breakpoint 3 lines up from the current line by <strong>break -3</strong>. Let's set a breakpoint at line 18 and continue the execution. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(gdb) break +3</span><br><span class="line">Breakpoint 3 at 0x8048450: file try5.c, line 18.</span><br><span class="line">(gdb) continue</span><br><span class="line">Continuing.</span><br><span class="line">i is 0.</span><br><span class="line">i is 1.</span><br><span class="line">i is 2.</span><br><span class="line"></span><br><span class="line">Breakpoint 3, display (x=5) at try5.c:18</span><br><span class="line">18      &#125;</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<p>Go ahead and quit gdb to prepare for the next section.</p>
<h3 id="setting-breakpoints-in-multiple-file-programs">3.2 Setting Breakpoints In Multiple File Programs</h3>
<p>How do we set breakpoints when a program spans multiple files?</p>
<p>For the form <strong>break linenumber</strong>, there is an ambiguity when you have a multiple file program. The line number of which file? The answer is that by default, the line number is taken as a line number in whatever file holds <strong>main()</strong>. That is certainly a reasonable default! But what if we wanted to break on line 5 of a different file? This gives a 4th form for the break command: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">break filename:linenumber</span><br></pre></td></tr></table></figure></p>
<p>This command will break on line linenumber of the source code file named filename. For example, <strong>break MyFuncs.c:102</strong> will break on line 102 of the source code file MyFuncs.c. There's a 5th form: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">break filename:function</span><br></pre></td></tr></table></figure></p>
<p>For example, <strong>break MyFuncs.c:MyPrintFunction</strong>. But unless you're using overloaded function names (you've defined a function multiple times), this is superfluous since you're not allowed (in C) to have 2 definitions belonging to the same function name.</p>
<h3 id="advanced-breaking">3.3 Advanced Breaking</h3>
<p>If you're trying to debug a program that doesn't have debugging info compiled into the executable, you can't set breakpoints by line number or function name. Instead you have to specify where to break by giving a memory address. This gives us a 6th form: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">break *address</span><br></pre></td></tr></table></figure></p>
<p>Since I know next to nothing about this, I'll move right along...</p>
<p>The <strong>break</strong> command without any argument gives a 7th form (only one more to go). It sets a break point at the very next instruction. Look at try5 again (having one eye on the source code will help here). <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1    $ gdb try5</span><br><span class="line">2    (gdb) break display</span><br><span class="line">3    Breakpoint 1 at 0x804841a: file try5.c, line 15.</span><br><span class="line">4    (gdb) run</span><br><span class="line">5    Starting program: /www/p/linux/gdb/try5 </span><br><span class="line">6</span><br><span class="line">7    Breakpoint 1, display (x=5) at try5.c:15</span><br><span class="line">8    15              for (i=0; i&lt;x; ++i) &#123;</span><br><span class="line">9    (gdb) next</span><br><span class="line">10   16                 printf(&quot;i is %d.\n&quot;, i);</span><br><span class="line">11   (gdb) print i</span><br><span class="line">12   $1 = 0</span><br><span class="line">13   (gdb) break</span><br><span class="line">14   Breakpoint 2 at 0x8048430: file try5.c, line 16.</span><br><span class="line">15   (gdb) continue</span><br><span class="line">16   Continuing.</span><br><span class="line">17   i is 0.</span><br><span class="line">18</span><br><span class="line">19   Breakpoint 2, display (x=5) at try5.c:16</span><br><span class="line">20   16                 printf(&quot;i is %d.\n&quot;, i);</span><br><span class="line">21   (gdb) print i</span><br><span class="line">22   $2 = 1</span><br></pre></td></tr></table></figure></p>
<p>The astute reader will wonder why, on line 22, i has the value of 1 and not 0. We set the breakpoint on line 13 when i had the value of 0. But the very next instruction (which is where we set the breakpoint) was just a printf statement (source code line 16). How in blazes did the printf increment the value of i?</p>
<p>Here's the answer. Once gdb stops at a breakpoint, it will ignore all other breakpoints until one line of instruction has executed. Why does it do this? If this weren't the case, everytime you stopped at a breakpoint, you'd have to disable that breakpoint to resume execution--you wouldn't be able to get past that breakpoint! If this doesn't make sense to you, think about it for awhile. If you still can't get it, don't worry. It's a minor point.</p>
<p>There's one more use for breakpoint form 7, the <strong>break</strong> command with no arguments. If you change to a higher frame, use <strong>break</strong> and then continue, the b <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ gdb try5</span><br><span class="line">(gdb) break display</span><br><span class="line">Breakpoint 1 at 0x804841a: file try5.c, line 15.</span><br><span class="line">15              for (i=0; i&lt;x; ++i) &#123;</span><br><span class="line">(gdb) backtrace</span><br><span class="line">#0  display (x=3) at try5.c:15</span><br><span class="line">#1  0x8048409 in main () at try5.c:8</span><br><span class="line">#2  0x4003e46b in __libc_start_main () from /lib/libc.so.6</span><br><span class="line">(gdb) frame 1</span><br><span class="line">#1  0x8048409 in main () at try5.c:8</span><br><span class="line">8          display(x);</span><br><span class="line">(gdb) break</span><br><span class="line">Breakpoint 2 at 0x8048409: file try5.c, line 8.</span><br><span class="line">(gdb) continue</span><br><span class="line">Continuing.</span><br><span class="line">i is 0.</span><br><span class="line">i is 1.</span><br><span class="line">i is 2.</span><br><span class="line"></span><br><span class="line">Breakpoint 2, 0x8048409 in main () at try5.c:8</span><br><span class="line">8          display(x);</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<p>Can you see what happened here? We stopped at the top of display(), frame 0. We then switched to the frame 1 (main()) and issued the break command. This set a breakpoint at the very next instruction after the call to display(). We then continued execution, and the program ran until it hit the very next instruction after display(). In essence, we set the breakpoint so that execution would halt after display() returned. Make sense?</p>
<p>To reiterate, the 7th form of breakpoint is used for loops when you're in the top most frame and returns from functions when you're not in the top most frame. Frankly, I don't find this terribly useful. When in a loop, I think the break +offset or break linenumber is more convenient. For returning from functions, I find the finish command more useful (which you'll learn about shortly).</p>
<p>The 8th and last form of break command is the conditional breakpoint. They are quite useful but little understood. Perhaps part of the reason is that the gdb User Manual does a really poor job explaining them. Here is the form: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">break ... if cond</span><br></pre></td></tr></table></figure></p>
<p>where ... represents any one of the previous 7 forms of breakpoints we've learned about already and cond is any conditional in the language you're using. Here is an example: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ gdb try5</span><br><span class="line">(gdb) break 16 if i==2</span><br><span class="line">Breakpoint 1 at 0x8048430: file try5.c, line 16.</span><br><span class="line">(gdb) r</span><br><span class="line">Starting program: /www/p/linux/gdb/try5 </span><br><span class="line">i is 0.</span><br><span class="line">i is 1.</span><br><span class="line"></span><br><span class="line">Breakpoint 1, display (x=3) at try5.c:16</span><br><span class="line">16                 printf(&quot;i is %d.\n&quot;, i);</span><br></pre></td></tr></table></figure></p>
<p>We used the 1st form of break with the conditional i==2. We could've also used a test for inequality, like i!=2 or i&gt;2. This is mega useful when you're inside of a loop that's going to repeat a million times. The 8th form of break is your friend!</p>
<h3 id="summary-of-breakpoints">3.4 Summary Of Breakpoints</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Form 1:	break linenumber	Set a breakpoint at line number linenumber</span><br><span class="line">Form 2:	break function	Set a breakpoint at function function.</span><br><span class="line">Form 3:	break filename:linenumber	Set a breakpoint at line linenum in source file filename.</span><br><span class="line">Form 4:	break *address	Set a breakpoint at address &lt;address&gt;. Use this to set breakpoints in parts of a program that doesn&apos;t have debugging information or source files.</span><br></pre></td></tr></table></figure>
<h3 id="deleting-breakpoints">3.5 Deleting Breakpoints</h3>
<p>Here are the commands used to delete breakpoints you've set when they've outlived their usefulness. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">clear &lt;function&gt;	Clear any breakpoints set at the entry to the function &lt;function&gt;.</span><br><span class="line">clear &lt;filename&gt;&lt;function&gt;	Clear any breakpoints set at the entry to the function &lt;function&gt; defined in the source code file &lt;filename&gt;.</span><br><span class="line">clear &lt;linenum&gt;	Clear any breakpoints set at line &lt;linenum&gt; of the current source file. The current source file is the last file whose text was printed.</span><br><span class="line">clear &lt;filename:linenum&gt;	Clear any breakpoints at line &lt;linenum&gt; in file &lt;filename&gt;.</span><br><span class="line">delete	Clear all breakpoints.</span><br><span class="line">delete n	Each breakpoint is assigned a number starting with 1. This clears breakpoint n.</span><br></pre></td></tr></table></figure></p>
<h3 id="inspecting-variables">3.6 Inspecting Variables</h3>
<p>Note to Fortran users: All Fortran variables must be in lowercase, regardless of how they were capitalized in your source code. This is because the Fortran standard specifies case independence when it comes to variables. Yes, variable C is variable c in the Fortran standard. There are compilers out there that allow you to use case dependent variables, but this is non-standard, and gcc mandates all lowercase variables. This was done to support legacy code. Sigh.</p>
<p>The whole purpose of setting a breakpoint or watchpoint is to see what's going on with your variables, so let's take a look at inspecting your variables. You can print the data type of a variable using the ptype command. Here are some examples: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(gdb) ptype argc</span><br><span class="line">type = int</span><br><span class="line">(gdb) ptype myfloat</span><br><span class="line">type = float</span><br><span class="line">(gdb) ptype argv </span><br><span class="line">type = char **</span><br><span class="line">(gdb) ptype mystring</span><br><span class="line">type = unsigned char *</span><br><span class="line">(gdb) pt myIntArray</span><br><span class="line">type = int [10]</span><br></pre></td></tr></table></figure></p>
<p>You can even use ptype to look at structures. Take, for example, the fstat structure defined in sys/stat.h. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">(gdb) ptype fstat</span><br><span class="line">type = struct stat &#123;</span><br><span class="line">    __dev_t st_dev;</span><br><span class="line">    short unsigned int __pad1;</span><br><span class="line">    __ino_t st_ino;</span><br><span class="line">    __mode_t st_mode;</span><br><span class="line">    __nlink_t st_nlink;</span><br><span class="line">    __uid_t st_uid;</span><br><span class="line">    __gid_t st_gid;</span><br><span class="line">    __dev_t st_rdev;</span><br><span class="line">    short unsigned int __pad2;</span><br><span class="line">    __off_t st_size;</span><br><span class="line">    long unsigned int st_blksize;</span><br><span class="line">    __blkcnt_t st_blocks;</span><br><span class="line">    __time_t st_atime;</span><br><span class="line">    long unsigned int __unused1;</span><br><span class="line">    __time_t st_mtime;</span><br><span class="line">    long unsigned int __unused2;</span><br><span class="line">    __time_t st_ctime;</span><br><span class="line">    long unsigned int __unused3;</span><br><span class="line">    long unsigned int __unused4;</span><br><span class="line">    long unsigned int __unused5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>That's quite a structure! You can abbreviate ptype by pt. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(gdb) pt mydouble</span><br><span class="line"></span><br><span class="line">type = double</span><br></pre></td></tr></table></figure></p>
<p>Remember, you can only print the data type of a variable which is defined in the currently selected frame.</p>
<p>Now that you know how to print the data type of your variables, you may want to print their values. Consider the following program (which will be compiled via gcc -g filename):<br>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">1   #include&lt;stdio.h&gt;</span><br><span class="line">2   #include&lt;string.h&gt;</span><br><span class="line">3   </span><br><span class="line">4   int main( int argc, char *argv[] )</span><br><span class="line">5   &#123;</span><br><span class="line">6        double mydouble = 3.14 / 3;</span><br><span class="line">7        float  myfloat  = 3.3;</span><br><span class="line">8        char   mychar   = &apos;A&apos;;</span><br><span class="line">9        int    myIntArray[10];</span><br><span class="line">10       int    MyNegativeInt = -1;</span><br><span class="line">11       char   myString[20];</span><br><span class="line">12  </span><br><span class="line">13       struct foo &#123;</span><br><span class="line">14            char *name;</span><br><span class="line">15            int  EyeColour;</span><br><span class="line">16       &#125; myStruct;</span><br><span class="line">17  </span><br><span class="line">18       strncpy(myString, &quot;hello&quot;, 19);</span><br><span class="line">19  </span><br><span class="line">20       for ( int i = 0; i &lt; 10; i++ )</span><br><span class="line">21            myIntArray[i] = i;</span><br><span class="line">22  </span><br><span class="line">23       return 0;</span><br><span class="line">24  &#125;</span><br></pre></td></tr></table></figure></p>
<p>You can view the value of a variable using the print command. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print i</span><br><span class="line">$4 = -1073744780</span><br></pre></td></tr></table></figure></p>
<p>I stopped the program right before the for loop, so this is what variable i is before it gets initialized. gdb prints the value of the variable which is most `comfortable' (to borrow fortran 99 lingo) with the datatype. In other words, floats get printed as floats: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print myfloat</span><br><span class="line">$1 = 3.29999995</span><br></pre></td></tr></table></figure></p>
<p>and doubles get printed as doubles: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print mydouble</span><br><span class="line">$1 = 1.0466666666666666</span><br></pre></td></tr></table></figure></p>
<p>and chars get printed as chars: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print mychar</span><br><span class="line">$1 = 65 &apos;A&apos;</span><br></pre></td></tr></table></figure></p>
<p>By the way, you can use the abbreviation p for print: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p argc</span><br><span class="line">$1 = 1</span><br></pre></td></tr></table></figure></p>
<p>You may be wondering what the numbers preceeded by <code>$ (like $1 or $3)</code> mean. They're kind of like a variable history. Everytime you print any variable, the $n gets incremented by 1. $ by itself refers to the last variable you printed and $n refers to the n'th variable you printed. Look at the following example to see this: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p mychar</span><br><span class="line">$26 = 65 &apos;A&apos;</span><br><span class="line">(gdb) p mydouble</span><br><span class="line">$27 = 1.0466666666666666</span><br><span class="line">(gdb) p $</span><br><span class="line">$28 = 1.0466666666666666</span><br><span class="line">(gdb) p $27</span><br><span class="line">$29 = 1.0466666666666666</span><br><span class="line">(gdb) p $26</span><br><span class="line">$30 = 65 &apos;A&apos;</span><br></pre></td></tr></table></figure></p>
<p>You can even typecast a variable when you print it! Here's MyNegativeInt as an int, char and double respectively: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p MyNegativeInt</span><br><span class="line">$41 = -1</span><br><span class="line">(gdb) p (char) MyNegativeInt</span><br><span class="line">$42 = -1 &apos;ÿ&apos;</span><br><span class="line">(gdb) p (double) MyNegativeInt</span><br><span class="line">$43 = -1</span><br></pre></td></tr></table></figure></p>
<p>The possibilities are endless. But wait, there's more!</p>
<h3 id="inspecting-arrays-and-structures">3.7 Inspecting Arrays And Structures</h3>
<p>Printing array values is much the same as printing other variables. gdb still uses the concept of being `comfortable'. In other words, when you print an array, that's exactly what you get! From the code snippet of the previous section: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p myIntArray</span><br><span class="line">$46 = &#123;0, 1, 2, 3, 4, 5, 6, 7, 8, 9&#125;</span><br></pre></td></tr></table></figure></p>
<p>Of course, gdb knows how to access elements of an array: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(gdb) pt myIntArray</span><br><span class="line">type = int [10]</span><br><span class="line">(gdb) pt myIntArray[3]</span><br><span class="line">type = int</span><br><span class="line">(gdb) p myIntArray[3]</span><br><span class="line">$48 = 3</span><br></pre></td></tr></table></figure></p>
<p>You can do kind of advanced stuff too -- things that you'd expect from only Perl :-). Here's how you print 5 elements of myIntArray, starting at element 3: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p myIntArray[3]@5</span><br><span class="line">$49 = &#123;3, 4, 5, 6, 7&#125;</span><br></pre></td></tr></table></figure></p>
<p>GDB will not, however, check bounds of the array. Previously we defined myIntArray as an array of 10 ints. Let's see what happens when we try printing 4 ints past the end of the array: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p myIntArray[3]@11</span><br><span class="line">$54 = &#123;3, 4, 5, 6, 7, 8, 9, 10, 1107293224, 1079194419, -1947051841&#125;</span><br></pre></td></tr></table></figure></p>
<p>Doh! Hopefully, that's not someone's password. :-). You can also print structures: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p myStruct</span><br><span class="line">$2 = &#123;name = 0x40014978 &quot;Miles Davis&quot;, EyeColour = 1&#125;</span><br></pre></td></tr></table></figure></p>
<p>However, this might get out of hand for very large structs. You can set pretty printing of structures by set print pretty: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(gdb) set print pretty</span><br><span class="line">(gdb) p myStruct</span><br><span class="line">$4 = &#123;</span><br><span class="line">  name = 0x40014978 &quot;Miles Davis&quot;, </span><br><span class="line">  EyeColour = 1</span><br><span class="line">&#125;</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure></p>
<p>or, if you only want one of the elements of the structure, you can print it in the way that would seem obvious: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print myStruct.name</span><br><span class="line">$6 = 0x40014978 &quot;Miles Davis&quot;</span><br></pre></td></tr></table></figure></p>
<p>this works too, but why is a mystery to me: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print myStruct-&gt;name </span><br><span class="line">$15 = 0x40014978 &quot;Miles Davis&quot;</span><br></pre></td></tr></table></figure></p>
<h3 id="advanced-inspection">3.8 Advanced Inspection</h3>
<p>You can print things using a format specifier: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print /FMT variable</span><br></pre></td></tr></table></figure></p>
<p>Where FMT is: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">o	octal		x	hex		d	decimal		u	unsigned decimal</span><br><span class="line">t	binary		f	float		a	address		c	char</span><br></pre></td></tr></table></figure></p>
<p>Here's some examples of printing some of our variables using a format specifier: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p mychar</span><br><span class="line">$33 = 65 &apos;A&apos;</span><br><span class="line">(gdb) p /o mychar</span><br><span class="line">$34 = 0101</span><br><span class="line">(gdb) p /x mychar </span><br><span class="line">$35 = 0x41</span><br><span class="line">(gdb) p /d mychar </span><br><span class="line">$36 = 65</span><br><span class="line">(gdb) p /u mychar </span><br><span class="line">$37 = 65</span><br><span class="line">(gdb) p /t mychar </span><br><span class="line">$38 = 1000001</span><br><span class="line">(gdb) p /f mychar </span><br><span class="line">$39 = 65</span><br><span class="line">(gdb) p /a mychar </span><br><span class="line">$40 = 0x41</span><br></pre></td></tr></table></figure></p>
<p>By the way, memory addresses in gdb are printed in hex by default. Therefore, p /a mychar prints mychar interpreted as an address, the hexidecimal representation of 65. This is very different from the address of mychar!</p>
<p>Speaking of the address of mychar, one would expect that since C loves pointers, gdb would love pointers too. And in fact, it does! Printing the address of mychar is obvious to C programmers (sorry, Fortran users!): <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p &amp;mychar</span><br><span class="line">$42 = 0xbffff41b &quot;A33S@¿Xò\213%¿ð?Hôÿ¿\023â\003@\001&quot;</span><br></pre></td></tr></table></figure></p>
<p>gdb even knows about the dereference operator. How's this for being perverse? <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) p *(&amp;mychar)</span><br><span class="line">$43 = 65 &apos;A&apos;</span><br></pre></td></tr></table></figure></p>
<p>This is the perfect vehicle for teaching students what a pointer is. We're dereferencing the address of mychar. Of course, there's more to this than just coolness (although it's worth it for the coolness factor alone!). I was writing a curses program once and it kept segfaulting on me whenever I tried drawing to a WINDOW object. By looking at the address of a WINDOW that I was passing to a function, I determined that I was passing a WINDOW by value, drawing to a local copy of the WINDOW and returning. Of course, the local copy of the WINDOW wasn't anything initialized by curses so drawing to it was causing a segmentation violation. Looking at the code, it was highly non-obvious what was was going on; it looked just swell! It wasn't until I compared the address of the passed WINDOW with the address of the received WINDOW that I discovered the big oops!</p>
<p>Furthermore, who here is guilty of buffer overruns? Be truthful! It's very easy to fall into the `off by one' error when you initialize, write to or read from a C array. How many times have you used strcpy when you should've used strncpy? These errors are insidious because they usually don't crash the program, but manifest themselves in wierd behavior in certain rare cases that are hard to track down. Looking at the addresses of what's going on is a sure fire way of finding out the details of what's going on.</p>
<h3 id="changing-variables">3.9 Changing Variables</h3>
<p>There are two ways you can change the value of a variable in gdb. Let's change the value of <strong>double myvariable</strong> to 10.0. Firstly, you can use the <strong>set</strong> command: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set myvariable = 10.0</span><br></pre></td></tr></table></figure></p>
<p>which is the 'quiet' way. gdb will simply set myvariable to 10 without printing anything. Then there's the 'noisy' way using the print command: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print myvariable = 10.0</span><br></pre></td></tr></table></figure></p>
<p>which will set <strong>myvariable</strong> to 10.0 and then print this new value to the screen. The <strong>print</strong> command ends up being less keystrokes because you can use the abbreviation <strong>p</strong> for <strong>print</strong>.</p>
<p>Remember, you can only change the value of a variable which is defined within the current context. Make sure the variable you want to change is defined in the currently selected frame. If it's not, you need to set the frame before you can change the variable.</p>
<h3 id="stepping-through-your-program">3.10 Stepping through your program</h3>
<p>One thing that is good to know is the exact sequence of execution of your program, especially through loops and conditional branches. If the program is not too large, you can follow it easily by executing one line at a time.</p>
<p>There are two commands used to step through your program:</p>
<p><strong>step:</strong><br>
Execute a single line in the program. If the current statement calls a function, the function is single stepped.<br>
<strong>next:</strong><br>
Execute a single line in the program but treat function calls as a single line. This command is used to skip over function calls.</p>
<p>Since C statements like printf() and scanf() are functions themselves, if you step through all your program (as opposed to next, you'll find yourself stepping through glibc, the standard C library (which is probably not what you want!). <strong>Good debugging makes use of next mostly</strong>. If you really want to step through a function call, it's best to set a breakpoint there and then you can use next from inside the function.</p>
<p>To execute the next statement, type: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">step</span><br></pre></td></tr></table></figure></p>
<p>Each time you type a step command, gdb will then list the line that it is about to execute, with the line number on the left, so you can see what's about to happen before it happens.</p>
<h3 id="finding-out-where-you-are-and-listing-source-code">3.11 Finding out where you are and listing source code</h3>
<p>To find out where you are at any time, type the command: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where</span><br></pre></td></tr></table></figure></p>
<p>This will show you the current line number. For example, a line like this: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#0  foo () at foo.f:12</span><br></pre></td></tr></table></figure></p>
<p>shows that the execution of our program is currently at a location that corresponds to line 12 in the Fortran source file, foo.f.</p>
<p>You can display a few lines of your source program around the current location by using the command: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list</span><br></pre></td></tr></table></figure></p>
<p>This will list 10 lines of source roughly centred on your current line number. If you haven't started to debug yet, it will list the first 10 lines of source code. If you type list again, it'll print the next 10 lines of source code. You can also type: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list 25</span><br></pre></td></tr></table></figure></p>
<p>and this will list 10 lines of source code centred on line 25. Typing list again will list the next 10 lines of source code. You can also specify a range of lines to be listed. For example, to list lines 10 through 24 in the current program, you'd type: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list 10,24</span><br></pre></td></tr></table></figure></p>
<p>If there is a function in your program named endpoints(), you can list 10 lines centred on the start of <strong>endpoints()</strong> by: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list endpoints</span><br></pre></td></tr></table></figure></p>
<p>If you're listing lines and decide you want to see the 10 lines previous to the 10 lines you just displayed: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list -</span><br></pre></td></tr></table></figure></p>
<p>Suppose you set a breakpoint: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">break 55</span><br></pre></td></tr></table></figure></p>
<p>and gdb responds with: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Breakpoint 1 at 0x8048540: file program3.c, line 55.</span><br></pre></td></tr></table></figure></p>
<p>You can list the lines centred around that address by specifying the asterisk (for address). It will list the 10 lines centred around the source code line containing that address. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list *0x8048540</span><br></pre></td></tr></table></figure></p>
<h2 id="debugging-a-running-process">4. Debugging A Running Process</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ./beer-process &amp;</span><br><span class="line">   [1] 17399</span><br><span class="line">   p@satan$ 100000 bottles of beer on the wall.</span><br><span class="line">   99999 bottles of beer on the wall.</span><br><span class="line">   99998 bottles of beer on the wall.</span><br><span class="line">   99997 bottles of beer on the wall.</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ gdb beer-process 17399</span><br><span class="line">Attaching to program: code/running_process/beer-process, process 17399</span><br><span class="line">0x410c64fb in nanosleep () from /lib/tls/libc.so.6</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure>
<h3 id="with-the-attach-command">4.1 With The Attach Command</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ gdb</span><br><span class="line">   (gdb) attach 17399</span><br><span class="line">   Attaching to process 17399</span><br><span class="line">   Reading symbols from code/running_process/beer-process...done.</span><br><span class="line">   0x410c64fb in nanosleep () from /lib/tls/libc.so.6</span><br><span class="line">   (gdb)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/c/" rel="tag"># c</a>
            
              <a href="/tags/gdb/" rel="tag"># gdb</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2016/09/06/sizeof/" rel="next" title="sizeof">
                  <i class="fa fa-chevron-left"></i> sizeof
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2016/09/13/sorting/" rel="prev" title="sorting">
                  sorting <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#using-gnus-gdb-debugger"><span class="nav-text">Using GNU&#39;s GDB Debugger</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#memory-layout-and-the-stack"><span class="nav-text">1. Memory Layout And The Stack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#breakpoints-and-watchpoints"><span class="nav-text">2. Breakpoints And Watchpoints</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#breaking"><span class="nav-text">2.1 Breaking</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#setting-basic-breakpoints"><span class="nav-text">2.2 Setting Basic Breakpoints</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#by-function-name"><span class="nav-text">2.2.1 By Function Name</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#by-line-number"><span class="nav-text">2.2.2 By Line Number</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#by-filename-and-line-number"><span class="nav-text">2.2.3 By Filename And Line Number</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#by-address"><span class="nav-text">2.2.4 By Address</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#breakpoint-numbers"><span class="nav-text">2.3 Breakpoint Numbers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#removing-breakpoints"><span class="nav-text">2.4 Removing Breakpoints</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exercises"><span class="nav-text">2.4.1 Exercises</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#enabling-disabling-and-ignoring"><span class="nav-text">2.5 Enabling, Disabling, And Ignoring</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exercises-1"><span class="nav-text">2.5.1 Exercises</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#listing-breakpoints"><span class="nav-text">2.6 Listing Breakpoints</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#stepping-and-resuming"><span class="nav-text">3. Stepping And Resuming</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#setting-breakpoints-in-single-file-programs"><span class="nav-text">3.1 Setting Breakpoints In Single File Programs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#setting-breakpoints-in-multiple-file-programs"><span class="nav-text">3.2 Setting Breakpoints In Multiple File Programs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#advanced-breaking"><span class="nav-text">3.3 Advanced Breaking</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#summary-of-breakpoints"><span class="nav-text">3.4 Summary Of Breakpoints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#deleting-breakpoints"><span class="nav-text">3.5 Deleting Breakpoints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inspecting-variables"><span class="nav-text">3.6 Inspecting Variables</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inspecting-arrays-and-structures"><span class="nav-text">3.7 Inspecting Arrays And Structures</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#advanced-inspection"><span class="nav-text">3.8 Advanced Inspection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#changing-variables"><span class="nav-text">3.9 Changing Variables</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#stepping-through-your-program"><span class="nav-text">3.10 Stepping through your program</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#finding-out-where-you-are-and-listing-source-code"><span class="nav-text">3.11 Finding out where you are and listing source code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#debugging-a-running-process"><span class="nav-text">4. Debugging A Running Process</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#with-the-attach-command"><span class="nav-text">4.1 With The Attach Command</span></a></li></ol></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.jpg"
      alt="yrb">
  <p class="site-author-name" itemprop="name">yrb</p>
  <div class="site-description" itemprop="description"></div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">42</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">47</span>
        <span class="site-state-item-name">tags</span>
        </a>
      </div>
    
  </nav>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yrb</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/muse.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script>



  








  <script src="/js/local-search.js?v=7.4.0"></script>














  

  
    
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

    
  

  

  

</body>
</html>
